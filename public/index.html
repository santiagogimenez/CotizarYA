<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CotizarYA - USDT a ARS</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üí±</text></svg>">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="header-top">
        <div>
          <h1>CotizarYA</h1>
          <p class="subtitle">Convert√≠ USDT a pesos argentinos en tiempo real</p>
        </div>
        <button class="theme-toggle" id="themeToggle" aria-label="Cambiar tema">
          <span class="theme-icon"></span>
        </button>
      </div>
      <div class="branding">
        <span class="branding-text">by</span>
        <span class="branding-name">SG Soluciones Tecnol√≥gicas</span>
      </div>
    </header>

    <main>
      <div class="rate-card">
        <div class="rate-info">
          <div class="rate-label">Cotizaci√≥n USDT/ARS</div>
          <div class="rate-value" id="rateValue">--</div>
          <div class="rate-source">
            <span id="rateSource">Binance P2P</span>
            <span class="rate-timestamp" id="rateTimestamp">--</span>
          </div>
        </div>
        <button class="btn-refresh" id="btnRefresh" title="Actualizar cotizaci√≥n">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
          </svg>
        </button>
      </div>

      <div class="calculator-card">
        <div class="form-group">
          <label for="usdtAmount">Monto en USDT</label>
          <input 
            type="number" 
            id="usdtAmount" 
            placeholder="Ej: 100" 
            min="0" 
            step="0.01"
            autocomplete="off"
          >
        </div>

        <div class="form-group">
          <label for="markup">Recargo / Markup (%)</label>
          <input 
            type="number" 
            id="markup" 
            placeholder="Ej: 5" 
            value="0"
            min="0" 
            step="0.5"
            autocomplete="off"
          >
        </div>

        <div class="form-group">
          <label for="rounding">Redondeo</label>
          <select id="rounding">
            <option value="0">Sin redondeo</option>
            <option value="10">Cada $10</option>
            <option value="50">Cada $50</option>
            <option value="100" selected>Cada $100</option>
            <option value="500">Cada $500</option>
          </select>
        </div>

        <div class="result-card">
          <div class="result-label">Precio final</div>
          <div class="result-value" id="resultValue">$ 0</div>
          <button class="btn-copy" id="btnCopy">Copiar precio</button>
        </div>
      </div>

      <!-- Comparador de Plataformas -->
      <div class="platforms-card">
        <div class="platforms-header">
          <div>
            <h3>üè¶ Comparador de Plataformas</h3>
            <p class="platforms-subtitle">Encontr√° la mejor cotizaci√≥n del mercado</p>
          </div>
          <button class="btn-refresh-platforms" id="btnRefreshPlatforms" title="Actualizar plataformas">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
            </svg>
          </button>
        </div>

        <div class="platforms-list" id="platformsList">
          <div class="platforms-loading">
            <div class="spinner"></div>
            <p>Consultando plataformas...</p>
          </div>
        </div>

        <div class="platforms-info">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 16v-4M12 8h.01"></path>
          </svg>
          <span>Los precios se actualizan cada 30 segundos. Verific√° siempre en la plataforma antes de operar.</span>
        </div>
      </div>

      <!-- Historial y Gr√°ficos -->
      <div class="history-card">
        <div class="history-header">
          <div>
            <h3>üìä Historial de Precios</h3>
            <p class="history-subtitle">Evoluci√≥n del USDT/ARS en el tiempo</p>
          </div>
          <div class="period-selector">
            <button class="period-btn active" data-period="1h">1h</button>
            <button class="period-btn" data-period="6h">6h</button>
            <button class="period-btn" data-period="24h">24h</button>
            <button class="period-btn" data-period="7d">7d</button>
            <button class="period-btn" data-period="30d">30d</button>
          </div>
        </div>

        <div class="history-stats">
          <div class="stat-item">
            <div class="stat-label">M√°ximo</div>
            <div class="stat-value" id="statMax">--</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">M√≠nimo</div>
            <div class="stat-value" id="statMin">--</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Promedio</div>
            <div class="stat-value" id="statAvg">--</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Variaci√≥n</div>
            <div class="stat-value" id="statChange">--</div>
          </div>
        </div>

        <div class="chart-container" id="chartContainer">
          <svg id="priceChart" width="100%" height="200" viewBox="0 0 800 200" preserveAspectRatio="none">
            <defs>
              <linearGradient id="chartGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:rgba(0,217,255,0.3);stop-opacity:1" />
                <stop offset="100%" style="stop-color:rgba(0,217,255,0);stop-opacity:1" />
              </linearGradient>
            </defs>
            <!-- Grid de referencia -->
            <g id="gridLines"></g>
            <!-- Etiquetas de precio -->
            <g id="priceLabels"></g>
            <!-- √Årea del gr√°fico -->
            <g id="chartArea"></g>
            <!-- L√≠nea de referencia vertical -->
            <line id="crosshair" x1="0" y1="0" x2="0" y2="200" stroke="#00d4ff" stroke-width="1" stroke-dasharray="4,4" opacity="0"/>
            <!-- Puntos interactivos -->
            <g id="dataPoints"></g>
          </svg>
          <!-- Tooltip flotante -->
          <div id="chartTooltip" class="chart-tooltip">
            <div class="tooltip-date"></div>
            <div class="tooltip-price"></div>
          </div>
          <div class="chart-empty" id="chartEmpty">
            <p>üìà Recopilando datos...</p>
            <span>El gr√°fico se poblar√° autom√°ticamente mientras uses la aplicaci√≥n</span>
          </div>
        </div>
      </div>

      <!-- Alertas de Precio -->
      <div class="alerts-card">
        <div class="alerts-header">
          <div>
            <h3>üîî Alertas de Precio</h3>
            <p class="alerts-subtitle">Te notificamos cuando el USDT llegue a tu precio objetivo</p>
          </div>
          <button class="btn-clear-alerts" id="btnClearAlerts" title="Limpiar alertas activadas">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path>
            </svg>
            Limpiar activadas
          </button>
        </div>

        <div class="alerts-form">
          <div class="form-row">
            <div class="form-group-inline">
              <label for="alertPrice">Precio objetivo (ARS)</label>
              <input 
                type="number" 
                id="alertPrice" 
                placeholder="Ej: 1200" 
                min="0" 
                step="0.01"
                autocomplete="off"
              >
            </div>
            <div class="form-group-inline">
              <label for="alertType">Tipo de alerta</label>
              <select id="alertType">
                <option value="above">Cuando suba a</option>
                <option value="below">Cuando baje a</option>
              </select>
            </div>
          </div>
          <button class="btn-add-alert" id="btnAddAlert">+ Crear Alerta</button>
        </div>

        <div class="alerts-list" id="alertsList">
          <div class="alerts-empty">
            <p>üì≠ No ten√©s alertas configuradas</p>
            <span>Configur√° una alerta para recibir notificaciones cuando el precio alcance tu objetivo</span>
          </div>
        </div>
      </div>

      <!-- Dollar Blue vs USDT -->
      <div class="comparison-card">
        <div class="comparison-header">
          <h3>üíµ D√≥lar Blue vs USDT</h3>
          <p class="comparison-subtitle">Compar√° cu√°l te conviene m√°s para comprar o vender</p>
        </div>

        <div class="comparison-rates">
          <div class="rate-box blue-rate">
            <div class="rate-box-header">
              <span class="rate-icon">üè¶</span>
              <span class="rate-title">D√≥lar Blue</span>
            </div>
            <div class="rate-box-prices">
              <div class="rate-price-item">
                <span class="rate-label">Compra</span>
                <span class="rate-value" id="blueCompra">--</span>
              </div>
              <div class="rate-price-item">
                <span class="rate-label">Venta</span>
                <span class="rate-value" id="blueVenta">--</span>
              </div>
            </div>
          </div>

          <div class="rate-box usdt-rate">
            <div class="rate-box-header">
              <span class="rate-icon">‚ÇÆ</span>
              <span class="rate-title">USDT P2P</span>
            </div>
            <div class="rate-box-prices">
              <div class="rate-price-item">
                <span class="rate-label">Compra</span>
                <span class="rate-value" id="usdtCompra">--</span>
              </div>
              <div class="rate-price-item">
                <span class="rate-label">Venta</span>
                <span class="rate-value" id="usdtVenta">--</span>
              </div>
            </div>
          </div>
        </div>

        <div class="comparison-calculator">
          <div class="comparison-input-group">
            <label for="comparisonAmount">Cantidad en USD</label>
            <input 
              type="number" 
              id="comparisonAmount" 
              placeholder="Ej: 100"
              min="1"
              step="1"
            >
          </div>

          <div class="comparison-results">
            <div class="comparison-result-card best">
              <div class="result-badge">‚úì Mejor Opci√≥n</div>
              <div class="result-title" id="bestOption">--</div>
              <div class="result-price" id="bestPrice">$ --</div>
              <div class="result-detail" id="bestDetail">--</div>
            </div>

            <div class="comparison-result-card">
              <div class="result-title" id="alternativeOption">--</div>
              <div class="result-price alternative" id="alternativePrice">$ --</div>
              <div class="result-detail" id="alternativeDetail">--</div>
            </div>
          </div>

          <div class="comparison-difference" id="comparisonDifference">
            <span class="difference-label">Diferencia:</span>
            <span class="difference-value">--</span>
          </div>
        </div>

        <div class="comparison-info">
          <p>üí° <strong>Tip:</strong> Los precios del d√≥lar blue pueden variar seg√∫n la casa de cambio. Esta comparaci√≥n usa promedios del mercado.</p>
        </div>
      </div>

      <!-- Calculadora de Comisiones -->
      <div class="commission-card" id="commissionCard" style="display: none;">
        <div class="commission-header">
          <h3>üí∞ Desglose de Comisiones</h3>
          <p class="commission-subtitle">Entend√© el costo real de tu operaci√≥n</p>
        </div>
        
        <div class="commission-content">
          <div class="commission-row">
            <span class="commission-label">Precio base (USDT √ó Cotizaci√≥n)</span>
            <span class="commission-value" id="commBase">$ 0</span>
          </div>
          
          <div class="commission-row highlight" id="markupRow" style="display: none;">
            <span class="commission-label">
              <span>Tu markup/recargo (<span id="commMarkupPercent">0</span>%)</span>
            </span>
            <span class="commission-value success" id="commMarkup">+ $ 0</span>
          </div>
          
          <div class="commission-divider"></div>
          
          <div class="commission-row">
            <span class="commission-label">Subtotal antes de redondeo</span>
            <span class="commission-value" id="commSubtotal">$ 0</span>
          </div>
          
          <div class="commission-row" id="roundingRow" style="display: none;">
            <span class="commission-label">Ajuste por redondeo</span>
            <span class="commission-value" id="commRounding">$ 0</span>
          </div>
          
          <div class="commission-divider"></div>
          
          <div class="commission-row total">
            <span class="commission-label">Total a cobrar</span>
            <span class="commission-value" id="commTotal">$ 0</span>
          </div>
        </div>
        
        <div class="commission-info">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 16v-4M12 8h.01"></path>
          </svg>
          <span>Este desglose te ayuda a entender cada peso que cobr√°s o pag√°s en la operaci√≥n.</span>
        </div>
      </div>

      <div class="status-message" id="statusMessage"></div>
    </main>

    <footer>
      <p>Cotizaci√≥n desde <strong>Binance P2P</strong> v√≠a CriptoYa</p>
      <p class="footer-note">Actualizaci√≥n autom√°tica cada 30 segundos</p>
      <p class="footer-brand">¬© 2025 SG Soluciones Tecnol√≥gicas</p>
    </footer>
  </div>

  <script src="app.js"></script>
</body>
</html>
